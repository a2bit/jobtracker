# ExternalSecret for CloudNativePG B2 credentials (jobtracker namespace)
# kubeconform-skip: ExternalSecret CRD
#
# Pulls Backblaze B2 credentials from 1Password for CNPG backup.
# Uses same credentials as Velero.
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: cnpg-b2-credentials
  namespace: jobtracker
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: onepassword
    kind: ClusterSecretStore
  target:
    name: cnpg-b2-credentials
    creationPolicy: Owner
  data:
    - secretKey: ACCESS_KEY_ID
      remoteRef:
        key: Backblaze B2 - Velero Backups
        property: Application Key ID
    - secretKey: ACCESS_SECRET_KEY
      remoteRef:
        key: Backblaze B2 - Velero Backups
        property: Application Key
